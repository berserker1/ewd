  <!DOCTYPE html>
  <html>
  <head>
    <title>On W.H.J. Feijen's solution for the lexicographic minimum of a circular list</title>
    <link href="https://fonts.googleapis.com/css?family=Lobster|Raleway" rel="stylesheet">
    <link href="assets/common.css" rel="stylesheet">
    <link href="assets/transcriptions.css" rel="stylesheet">
    <link href="assets/tweet-selection.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-1.12.0.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="assets/tweet-selection.js"></script>
    <meta name="generator" content="convertArticle.pl">
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@raboofje" />
    <meta name="twitter:description" content="From the Edsger Dijkstra EWD archive: On W.H.J. Feijen's solution for the lexicographic minimum of a circular list" />
    <meta name="twitter:title" content="On W.H.J. Feijen's solution for the lexicographic minimum of a circular list" />
    <meta name="twitter:image" content="http://raboof.github.io/ewd/assets/dijkstra.jpeg" />
  </head>
  <body>
  <div class="metabar">
    <div class="metabar-inner">
      <a href="index.html">HOME</a>
    </div>
  </div>
  <h1>On W.H.J. Feijen's solution for the lexicographic minimum of a circular list</h1>
  <div class='body'>
<hr>
<p class="noindent">NOTE: This transcription was contributed by Martin P.M. van der Burgt, who has devised a process for producing transcripts automatically. Although its markup is incomplete, we believe it serves a useful purpose by virtue of its searchability and its accessibility to text-reading software. It will be replaced by a fully marked-up version when time permits. —HR</p>
<hr>
<p class="noindent"><b>On W.H.J. Feijen's solution for the lexicographic minimum of a circular list</b>.</p>
<p>For a given, non-empty —i.e. with N ≥ 1— list (C[0], C[1], ..., C[N-1]) we consider the N associated sequences C<sub>i</sub></p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>Ci = (C[i], C[i+1], ..., C[i+N-1])</td>
</tr>
</table>
in which all subscripts are reduced modulo N. We are asked to design a program determining an integer value k satisfying the relation
<table width="100%">
<tr>
<td valign="top" width="10%">R:</td>
<td>0 ≤ k &lt; N <b>and</b> (∀i: 0 ≤ i &lt; N: C<sub>i</sub> <u>GE</u> C<sub>k</sub>) ,</td>
</tr>
</table>
in which "<u>GE</u>" should be read as "lexicographically greater or equal than".
<p align="center" class="noindent">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
*</p>
<p>The lexicographic minimum CC is defined by the following two relations.</p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td valign="top">(∀i: 0 ≤ i &lt; N: C<sub>i</sub> <u>GE</u> CC)</td>
<td align="right">(0)</td>
</tr>
<tr>
<td valign="top"></td>
<td valign="top">(∃i: 0 ≤ i &lt; N: C<sub>i</sub> <u>EQ</u> CC)</td>
<td align="right">(1)</td>
</tr>
</table>
From the transitivity of the lexicographic ordering we conclude
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td valign="top">(∀p, q:: C<sub>p</sub> <u>GE</u> C<sub>q</sub> <b>or</b> C<sub>q</sub> <u>GT</u> CC)</td>
<td align="right">(3)</td>
</tr>
</table>
<b>Note</b>. When, in a quantification, the range is obvious, we allow ourselves its omission. Hence the "::". (End of note)
<p align="center" class="noindent">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
*</p>
<p>Let P(k,n) be defined as:</p>
<table width="100%">
<tr>
<td valign="top" width="10%">P:</td>
<td valign="top">0 ≤ k &lt; n <b>and</b> (∀i; 0 ≤ i &lt; n: C<sub>i</sub> <u>GT</u> CC <b>or</b> i = k)</td>
<td align="right">(4)</td>
</tr>
</table>
We observe immediately
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td valign="top">(P <b>and</b> n ≥ N) ⇒ R</td>
<td align="right">(5)</td>
</tr>
<tr>
<td valign="top"></td>
<td valign="top">(∀i: 0 ≤ i &lt; h: C<sub>i</sub> <u>GT</u> CC) ⇒ P(h, h+1)</td>
<td align="right">(6)</td>
</tr>
</table>
<p align="center" class="noindent">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
*</p>
<p>Let Q(k, n, l) be defined as</p>
<table width="100%">
<tr>
<td valign="top" width="10%">Q:</td>
<td valign="top">0 ≤ k &lt; n ∧ (∀i: 0 ≤ i &lt; l: C[k+i] = C[n+i])</td>
<td align="right">(7)</td>
</tr>
</table>
<p>Because the lexicographic order of the two sequences with equal leading elements does not change when those leading elements are removed from them, we conclude</p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td valign="top">Q(k,n,l) ⇒ (Q<sub>a</sub> <b>or</b> Q<sub>b</sub> <b>or</b> Q<sub>c</sub>)</td>
<td align="right">(8)</td>
</tr>
</table>
with the mutually exclusive terms
<table width="100%">
<tr>
<td valign="top" width="10%">Qa:</td>
<td valign="top">(∀i: 0 ≤ i &lt; N: C<sub>k+i</sub> = C<sub>n+i</sub></td>
<td align="right">(8a)</td>
</tr>
<tr>
<td valign="top">Qb:</td>
<td valign="top">(∀i: 0 ≤ i &lt; l: C<sub>k+i</sub> <u>LT</u> C<sub>n+i</sub> ∧ l ≥ 0</td>
<td align="right">(8b)</td>
</tr>
<tr>
<td valign="top">Qc:</td>
<td valign="top">(∀i: 0 ≤ i &lt; N: C<sub>k+i</sub> <u>GT</u> C<sub>n+i</sub> ∧ l ≥ 0</td>
<td align="right">(8c)</td>
</tr>
</table>
<p>We furthermore observe that, for l=0, the last term of Q(k, n, l) is vacuously true.</p>
<p align="center" class="noindent">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
*</p>
<p>We observe that P&amp;ans;Q can be initialized by</p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>k, n, l:= 0, 1, 0</td>
</tr>
</table>
and is left invariant by the following three guarded commands.
<table width="100%">
<tr>
<td valign="top" width="10%">1)</td>
<td>C[k + l] = C[n + l] → l:= l + 1</td>
</tr>
</table>
<p>This follows immediatly from (4) —l does not occur in P— and (7)</p>
<table width="100%">
<tr>
<td valign="top" width="10%">2)</td>
<td>C[k + l] &lt; C[n + l] → {P∧Qb} n, l:= n + l + 1, 0</td>
</tr>
</table>
<p>Q and the guard imply together Qb, and note that Qb implies</p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>(∀i: n ≤ i &lt; n+l+1: C<sub>I</sub> <u>GT</u> CC)</td>
</tr>
</table>
Hence, on account of (4) the invariance of P is guaranteed. The assignment l:= 0 ensures the invariance of Q
<table width="100%">
<tr>
<td valign="top" width="10%">3)</td>
<td>C[k + l] &gt; C[n + l] → {P∧Qc} n, l:= n + l + 1, 0</td>
</tr>
</table>
<table width="100%">
<tr>
<td valign="top" width="30%"></td>
<td>h:= max(n, k+l+1);</td>
</tr>
<tr>
<td valign="top"></td>
<td>k, n, l:= h, h+1, 0</td>
</tr>
</table>
<p>Q and the guard imply together Qc, and note that Qc implies</p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>(∀i: k ≤ i &lt; n+l+1: C<sub>i</sub> <u>GT</u> CC) ∧ l ≥ 0 .</td>
</tr>
</table>
With h = max(n, k+l+1) we conclude from the last result and P
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>(∀i: 0 ≤ i &lt; h: C<sub>i</sub> <u>GT</u> CC)</td>
</tr>
</table>
and, thanks to (6), the invariance of P is guaranteed. The assignment l:= 0 ensures the invariance of Q .
<p align="center" class="noindent">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
*</p>
<p>Finally we show that</p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td valign="top">(P ∧ Q ∧ k + l + 1 ≥ N) ⇒ R</td>
<td align="right">(9)</td>
</tr>
</table>
<p class="noindent"></p>
<table width="100%">
<tr>
<td valign="top" width="10%">1)</td>
<td>P ∧ Qa ∧ k + l + 1 ≥ N</td>
</tr>
</table>
<p>From Qa we conclude that the sequence is periodic, and that the period divides n - k; hence</p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>(∃i: k ≤ i &lt; n: C<sub>i</sub> <u>EQ</u> CC)</td>
</tr>
</table>
Together with —what follows from P—
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>(∀i: k &lt; i &lt; n: C<sub>i</sub> <u>GT</u> CC)</td>
</tr>
</table>
we conclude C<sub>k</sub> <u>EQ</u> CC, i.e. R .
<p class="noindent"></p>
<table width="100%">
<tr>
<td valign="top" width="10%">2)</td>
<td>P ∧ Qb ∧ k+l+1 ≥ N</td>
</tr>
</table>
<p>From Qb we conclude, as before,</p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>(∀i: n ≤ i &lt; n+l+1: C<sub>i</sub> <u>GT</u> CC);</td>
</tr>
</table>
because n &gt; k, n+l+1 &gt; k+l+1; because k+l+1 ≥ N we conclude, together with P
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>(∀i: 0 ≤ i &lt; N: C<sub>i</sub> <u>GT</u> CC <b>or</b> i = k), i.e. R</td>
</tr>
</table>
<p class="noindent"></p>
<table width="100%">
<tr>
<td valign="top" width="10%">3)</td>
<td>P ∧ Qc ∧ k+l+1 ≥ N</td>
</tr>
</table>
<p>From Qc we conclude, as before,</p>
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>(∀i: k ≤ i &lt; k+l+1: C<sub>i</sub> <u>GT</u> CC);</td>
</tr>
</table>
because k+l+1 ≥ N, we conclude, together with P
<table width="100%">
<tr>
<td valign="top" width="10%"></td>
<td>(∀i: 0 ≤ i &lt; N: C<sub>i</sub> <u>GT</u> CC);</td>
</tr>
</table>
this together with (1) implies <b>false</b>, and <b>false</b> ⇒ R.
<p>(End of Proof of (9).)</p>
<p>Using (5) and (9), we see that the following program establishes R</p>
<table>
<tr>
<td>&nbsp; &nbsp; &nbsp;</td>
<td colspan="4">k, n, l:= 0, 1, 0</td>
</tr>
<tr>
<td></td>
<td colspan="4"><b>do</b> n &lt; N <b>and</b> k + l + 1 &lt; N →</td>
</tr>
<tr>
<td></td>
<td>&nbsp; &nbsp; &nbsp; &nbsp;</td>
<td colspan="3"><b>if</b> C[k + l] = C[n + l] → l:= l + 1 {P ∧ Q}</td>
</tr>
<tr>
<td></td>
<td></td>
<td>&nbsp;</td>
<td colspan="2">▯ C[k + l] &lt; C[n + l] → n, l:= n + l + 1, 0 {P ∧ Q}</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td colspan="2">▯ C[k + l] &gt; C[n + l] → h:= max(n, k + l + 1);</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</td>
<td>k, n, l:= h, h + 1, 0 {P ∧ Q}</td>
</tr>
<tr>
<td></td>
<td></td>
<td colspan="3"><b>fi</b> {P ∧ Q}</td>
</tr>
<tr>
<td></td>
<td colspan="4"><b>od</b> {R}</td>
</tr>
</table>
<p class="noindent"><b>Termination</b>. The function t = k + n + l increases by at least one at each iteration. Before the first iteration t = 1, before the last one t ≤ 2N - 3, hence 2N - 3 is an upper bound for the number of comparisons.</p>
<p align="center" class="noindent">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
*</p>
<p>The above is —or will be— described much more beautifully by W.H.J. Feyen, including all the heuristics and acknowledgements. I wrote the above as part of my personal correspondence, for the sake of quick dissemination: I owe everything of the above to ir. W.H.J. Feijen.</p>
<p class="noindent"></p>
<table width="100%">
<tr>
<td valign="top" width="50%">29th December 1979</td>
<td></td>
</tr>
<tr>
<td valign="top">Plataanstraat 5</td>
<td></td>
</tr>
<tr>
<td valign="top">5671 AL Nuenen</td>
<td>prof.dr.Edsger W.Dijkstra</td>
</tr>
<tr>
<td valign="top">The Netherlands</td>
<td>Burroughs Research Fellow</td>
</tr>
</table>
<hr>
<p class="noindent"><font size="-1">Transcribed by Martin P.M. van der Burgt<br>
Last revision <!-- #BeginDate format:IS1 -->2015-04-11<!-- #EndDate -->
 .</font></p>
<p>&nbsp;</p>
</div>
  <script>
$('.body').tweetSelection({
  ellipsis: '...',
  quoteLeft: '\'',
  quoteRight: '\'',
  via: 'raboofje'
});
  </script>
  </body>
  </html>
