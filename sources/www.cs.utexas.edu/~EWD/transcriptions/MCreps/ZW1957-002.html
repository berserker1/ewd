<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>

	<head>
		<title>E.W.Dijkstra Archive: A method to investigate primality (ZW1957-002)</title>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<link href="../transcriptions.css" rel="stylesheet" media="screen">
		<link href="../formulas.css" rel="stylesheet" media="screen">

		<style type="text/css">
/*				font-family: AppleGothic, "arial unicode ms", arial;   */
			body {       line-height: 1.5em; }
			body table { line-height: 2em; }
			p { 	       text-indent: 0em; }  /* overwrite the indentation defined by "transcriptions.css" */
		</style>

	</head>

	<body>

		<div id="frame">
			<div id="content">
				<p align=center>STICHTING<br><span style="font-size: 1.5em;">MATHEMATISCH CENTRUM</span><br>2e BOERHAAVESTRAAT 49<br>AMSTERDAM<br><br><a href="../../MCReps/ZW1957-002.PDF" title="PDF scan of ZW1957-002">ZW 1957-002</a><br><br>Voordracht in de serie "Actualiteiten"<br><br>E.W. Dijkstra<br><br>Zaterdag 26 januari 1957<br><br><br><u>A method to investigate primality</u><br><br><br><img src="ZW1957-002.png" alt="SMC logo" title="SMC logo"><br>1957<br><br>
				<hr>
				<p align=center><br>Voordracht in de serie "Actualiteiten"<br>door<br><u>E.W. Dijkstra</u><br>op<br>Zaterdag 26 Januari 1957<br><br><br><u>A method to investigate primality</u><br><br>
				<p>The method determines the smallest odd prime factor of a number N by testing the remainders left after division by the successive odd numbers 3, 5, ...
					<span class=inlineformula><var>f</var><table class=supsub><tr><td><br><var>m</var></table>-2</span>,
					<span class=inlineformula><var>f</var><table class=supsub><tr><td><br>
				  <var>m</var></table>;</span> here
					<span class=inlineformula><var>f</var><table class=supsub><tr><td><br><var>m</var></table></span> is the largest  odd number not exceeding <var>N</var><sup>½</sup>. If none of these remainders vanishes, <var>N</var> is a prime number.
				<p>Let <var>f</var> be one of the odd divisors or odd trial divisors. Remainder
					<span class=inlineformula><var>r</var><table class=supsub><tr><td><br>0</table></span> and quotient
					<span class=inlineformula><var>q</var><table class=supsub><tr><td><br>0</table></span> are defined by the relations
				<p style="text-align: center;"><var>N</var> =
					<var>r</var><table class=supsub><tr><td><br>0</table>
					+ <var>f</var>.<var>q</var><table class=supsub><tr><td><br>0</table>, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &#x2264;
					<var>r</var><table class=supsub><tr><td><br>0</table> &lt; <var>f</var>.
				<p>Now <span class=inlineformula><var>q</var><table class=supsub><tr><td><br>0</table></span> is divided by <span class=inlineformula><var>f</var> + 2,</span> giving
				<p style="text-align: center;"><var>q</var><table class=supsub><tr><td><br>0</table>
					= <var>r</var><table class=supsub><tr><td><br>1</table> + (<var>f</var>
					+ 2).<var>q</var><table class=supsub><tr><td><br>1</table>, &nbsp; &nbsp; &nbsp; 0 &#x2264;
					<var>r</var><table class=supsub><tr><td><br>1</table> &lt; <var>f</var> + 2 .
				<p>Then <var>q</var><table class=supsub><tr><td><br>1</table> is divided by (<var>f</var> + 4) etc. and this process is continued till a quotient
					<span class=inlineformula>(<var>q</var><table class=supsub><tr><td><br><var>n</var></table></span> say) equal to zero is found;
					<span class=inlineformula><var>r</var><table class=supsub><tr><td><br><var>n</var></table></span> is the last remainder in the sequence unequal to zero. After elimination of the
					<span class=inlineformula><var>q</var><table class=supsub><tr><td><br>i</table></span> we get the relations
					<table class=numfor><tr><td class=numforcenter><var>N</var>
					= <span class=inlineformula><var>r</var><table class=supsub><tr><td><br>0</table></span>
					+ <span class=inlineformula><var>f</var>.<var>r</var><table class=supsub><tr><td><br>1</table></span>
					+ <span class=inlineformula><var>f</var>.(<var>f</var>+2)<var>r</var><table class=supsub><tr><td><br>2</table></span>
					+	<span class=inlineformula><var>f</var>.(<var>f</var>+2).(<var>f</var>+4)<var>r</var><table class=supsub><tr><td><br>3</table></span> + ... +	<span class=inlineformula><var>f</var>.(<var>f</var>+2)
					... (<var>f</var>+2<var>n</var>-2).<var>r</var><table class=supsub><tr><td><br>
				  <var>n</var></table></span></td><td class=numforright>&nbsp;&nbsp;&nbsp;(1)</td></table> and <table class=numfor><tr><td class=numforcenter>0 &#x2264;
					<var>r</var><table class=supsub><tr><td><br>i</table> &lt; <var>f</var> + 2<var>i</var></td><td class=numforright>&nbsp;&nbsp;&nbsp;(2)</td></table>
				<p>Once the sequence <span class=inlineformula><var>r</var><table class=supsub><tr><td><br>i</table></span> is known for a given value of <var>f</var>, it is easy to compute the corresponding sequence
					<span class=inlineformula><var>r</var><table class=supsub><tr><td>*<br>i</table>,</span> defined by the relations (1) and (2) with respect to
					<span class=inlineformula><var>f</var><table class=supsub><tr><td>*<br>&nbsp;</table> = <var>f</var> + 2,</span> as they are expressed in terms of the
					<span class=inlineformula><var>r</var><table class=supsub><tr><td><br>i</table></span> by the recurrence relations
					<table class=numfor><tr><td class=numforcenter><span class=inlineformula><var>b</var><table class=supsub><tr><td><br>0</table></span> = 0,
					<span class=inlineformula><var>r</var><table class=supsub><tr><td>*<br>i</table></span>
						= <span class=inlineformula><var>r</var><table class=supsub><tr><td><br>i</table></span>
						- 2(<var>i</var>+1)<span class=inlineformula><var>r</var><table class=supsub><tr><td><br>
					      <var>i</var>+1</table></span> - <span class=inlineformula><var>b</var><table class=supsub><tr><td><br>
			          <var>i</var>
				    </table></span> + <span class=inlineformula>(<var>f</var><table class=supsub><tr><td>*<br>&nbsp;</table>+2<var>i</var>)<var>b</var><table class=supsub><tr><td><br>
				      <var>i</var>+1
		      </table></span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class=inlineformula>(<var>i</var> = 0, 1, ..., <var>n</var>)</span></td><td class=numforright>&nbsp;&nbsp;&nbsp;(3)</td></table>
				<p>The relation corresponding to (1) is satisfied for arbitrary values of the numbers
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>
				  <var>i</var>
					</table></span> with <span class=inlineformula><var>i</var> &#x2265; 1;</span> they are fixed, however, by the relations corresponding to (2)
					<table class=numfor><tr><td class=numforcenter><span class=inlineformula>0 &#x2264;
					<var>r</var><table class=supsub><tr><td>*<br>
					<var>i</var>
					</table> &lt; <var>f</var><table class=supsub><tr><td>*<br>&nbsp;</table> + 2<var>i</var> .</span></td><td class=numforright>&nbsp;&nbsp;&nbsp;(2*)</td></table>
				<p>On account of the inequalities (2) and (2*) &mdash;and
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>0</table> 
					= 0</span>&mdash; the <span class=inlineformula><var>b</var><table class=supsub><tr><td><br>
					<var>i</var></table></span> satisfy the inequalities
					<table class=numfor><tr><td class=numforcenter><span class=inlineformula>0 &#x2264;
					<var>b</var><table class=supsub><tr><td><br>
					<var>i</var>
		      </table> &#x2264; 2<var>i</var> .</span></td><td class=numforright>&nbsp;&nbsp;&nbsp;(4)</td></table>
				<p>We have chosen <span class=inlineformula><var>b</var><table class=supsub><tr><td><br>0</table> = 0.</span>
					Then the relations (3) and (2*) with <span class=inlineformula><var>i</var> = 0</span> determine
					<span class=inlineformula><var>r</var><table class=supsub><tr><td>*<br>0</table></span> and
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>1</table>;</span> once
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>1</table></span> is known, (3) and (2*) with <span class=inlineformula><var>i</var> = 1</span> determine
					<span class=inlineformula><var>r</var><table class=supsub><tr><td>*<br>1</table></span> and
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>2</table>,</span> etc. The process is easily programmed.
					[unreadable] 0, and the inequalities (2*) with <span class=inlineformula><var>i</var> = <var>n</var></span> are always satisfied with
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>
					<var>n</var>+1
					</table> = 0,</span> the process terminates with
					<table class=numfor><tr><td class=numforcenter><span class=inlineformula><var>r</var><table class=supsub><tr><td>*<br>
					<var>n</var></table> = <var>r</var><table class=supsub><tr><td><br>
					<var>n</var></table> - <var>b</var><table class=supsub><tr><td><br>
					<var>n</var></table></span></td></table>
				<p>As soon as <span class=inlineformula><var>r</var><table class=supsub><tr><td>*<br><var>n</var></table> = 0</span> is found &mdash;in that case it can be proved, that
					<span class=inlineformula><var>r</var><table class=supsub><tr><td>*<br><var>n</var>-1</table> 
					&#x2260; 0&mdash; </span>the index <var>n</var>, marking the last <span class=inlineformula><var>r</var><table class=supsub><tr><td><br>
				  <var>i</var>
					</table> &#x2260; 0</span> in the sequence, is lowered by 1.
				<p>In order to find the smallest odd prime factor of <var>N</var>, the <span class=inlineformula><var>r</var><table class=supsub><tr><td><br>
				  <var>i</var>
					</table></span> defined by (2) and (3) and <span class=inlineformula><var>f</var> = 3</span> are computed. Here the only divisions in the process are carried out. At the same time the initial value of <var>n</var> is found. If <var>N</var> is large, this value may be considerable: for instance <span class=inlineformula><var>n</var> = 11</span> is found for <span class=inlineformula><var>N</var> &#x2248; 10<sup>13</sup>.</span> The amount of work involved in each step is roughly proportional to <var>n</var><sup>2</sup>. Fortunately large initial values of <var>n</var> decrease very rapidly. As soon as <span class=inlineformula><var>f</var>.(<var>f</var> + 2).(<var>f</var> + 4) &gt; <var>N</var>,</span> <var>n</var> takes the value 2. This is its minimum value: when
					<span class=inlineformula><var>r</var><table class=supsub><tr><td>*<br>
				  <var>n</var>
					</table> = 0</span> with <span class=inlineformula><var>n</var> = 2</span> is found
					<span class=inlineformula>(<var>f</var><table class=supsub><tr><td>*<br>&nbsp;</table> + 2)<sup>2</sup> &gt; <var>N</var></span> holds and <var>N</var> is a prime number. (If not, we should have found a
					<span class=inlineformula><var>r</var><table class=supsub><tr><td><br>0</table> = 0</span> earlier and should have stopped there.)
				<p>The process still may be speeded up. Let
					<span class=inlineformula><var>b</var><table class=supsub><tr><td>'<br><var>n</var></table></span> be the minimum of
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>
				  <var>n</var>
					</table></span> for fixed <var>n</var> up till a certain moment: then it can be shown that the next
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>
				  <var>n</var>
					</table></span> satisfies
					<table class=numfor><tr><td class=numforcenter><span class=inlineformula><var>b</var><table class=supsub><tr><td><br><var>n</var></table> &#x2264; <var>b</var><table class=supsub><tr><td>'<br><var>n</var></table> + 1 .</span></td><td class=numforright>&nbsp;&nbsp;&nbsp;(5)</td></table>
				<p>Let us apply this to the last stage <span class=inlineformula><var>n</var> = 2.</span> According to (4) <span class=inlineformula><var>b</var><table class=supsub><tr><td><br>2</table></span> satisfies
					<span class=inlineformula>0 &#x2264; <var>b</var><table class=supsub><tr><td><br>2</table> &#x2264; 4.</span> According to (5), however, the only possible values for
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>2</table></span> are 0 and 1 as soon as a value
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>2</table> = 0</span> once has been found. This is bound to happen for <var>f</var> ranging (roughly) from
					<span class=inlineformula>(4<var>N</var>)<table class=supsub><tr><td>1/3<br>&nbsp;</table></span> till
					<span class=inlineformula>(8<var>N</var>)<table class=supsub><tr><td>1/3<br>&nbsp;</table>.</span> In the case
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br>2</table> = 0</span> it is apparently unnecessary to test whether
					<span class=inlineformula><var>r</var><table class=supsub><tr><td><br>2</table> = 0</span> is reached. (If <span class=inlineformula><var>N</var> &#x2265; 144,</span> the case
					<span class=inlineformula><var>b</var><table class=supsub><tr><td><br><var>n</var></table> = 0</span> with <span class=inlineformula><var>n</var> = 2</span> occurs, before
					<span class=inlineformula><var>r</var><table class=supsub><tr><td>*<br><var>n</var></table> = 0</span> with <span class=inlineformula><var>n</var> = 2</span> is found: prime numbers are then always detected in this last stage.)
				<p>The less efficient steps of the process for large <var>n</var> (i.e. small <var>f</var>) could be avoided by carrying out divisions for small values of <var>f</var>. (Cf. the method suggested by G.G. Alway, <i>MTAC</i> v. 6, p. 59-60, where one seems to be obliged to do this for <var>f</var> up to
					<span class=inlineformula>(8<var>N</var>)<table class=supsub><tr><td>1/3<br>&nbsp;</table>.)</span> However we strongly advise not to do this. 
				<p>If the process described above is started at <span class=inlineformula><var>f</var> = 3,</span> the <em>whole</em> computation can be checked at the end by inserting the final values of <var>f</var> and
					<span class=inlineformula><var>r</var><table class=supsub><tr><td><br><var>i</var></table></span> into (1). As all the intermediate results are used in the computation, this check seems satisfactory.
				<p>If a double length number <var>N</var> is to be investigated, another argument can be added: division of <var>N</var> by small <var>f</var> may give a double length quotient, i.e. two divisions (and two multiplications to check) are needed for each <var>f</var>. In our case even only part of the initial <var>n</var> divisions are double length divisions.
			  <p>If some consecutive odd numbers are to be investigated, the initial divisions are only necessary for the first number <var>N</var>; it is easy to compute the sequence of initial remainders
					<span class=inlineformula><var>r</var><table class=supsub><tr><td><br><var>i</var>
			  </table></span> "representing <span class=inlineformula><var>N</var> + <var>d</var></span> at <span class=inlineformula><var>f</var> = 3<var>"</var></span> from the corresponding sequence for <var>N</var> at <span class=inlineformula><var>f</var> = 3,</span> if <var>d</var> is small.
<p>The process described above has been programmed for the ARMAC (<u>A</u>utomatische <u>R</u>ekenmachine van het <u>MA</u>thematisch <u>C</u>entrum). The speed of this machine is about 2400 operations per second. A twelve decimal number was identified as the square of a prime in less than 23 minutes.
					<br>
					<br>
					<br>

				<!-- end signatures -->
				<hr>
				<!-- name and date -->
				<div id="footer">
					<font size="-1">
 	        transcribed by Corrado Cantelmi<br>
						 revised 
						 <!-- #BeginDate format:En2 -->20-Sep-2011<!-- #EndDate -->
					</font>
				</div>

			</div>  <!-- "content" -->

		</div>  <!-- "frame" -->

	</body>
</html>


